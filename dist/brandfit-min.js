const analyze=e=>{e.preventDefault(),selectors.usernameErrorLabel.style.display="none",selectors.brandnameErrorLabel.style.display="none";const t=getValue(`[${prefix[0]}=brandname]`),r=getValue(`[${prefix[0]}=username]`);if(!t.length)return void(selectors.brandnameErrorLabel.style.display="block");if(!r.length)return void(selectors.usernameErrorLabel.style.display="block");const s=getElement(`[${prefix[0]}=email]`),l=getElement(`[${prefix[0]}=name]`);s.value="",l.value="",selectors.popupForm.style.display="flex",selectors.brandPopup.style.display="block",selectors.brandPopupError.style.display="none",selectors.brandPopupSuccess.style.display="none"},invalidEmailDomains=["gmail.com","yahoo.com","hotmail.com","competitor.com"],validEmail=e=>{const t=e.split("@")[1];if(!e?.length)return!1;if(invalidEmailDomains.includes(t))return!1;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},formSubmit=async e=>{if(e.preventDefault(),selectors.emailErrorLabel.style.display="none",selectors.nameErrorLabel.style.display="none",selectors.brandPopupError.style.display="none",selectors.brandPopupSuccess.style.display="none",!validEmail(getValue(`[${prefix[0]}=email]`)))return void(selectors.emailErrorLabel.style.display="block");if(!getValue(`[${prefix[0]}=name]`).length)return void(selectors.nameErrorLabel.style.display="block");selectors.submitBtnLoader.style.display="block",selectors.submitBtn.value="",selectors.username=getValue(`[${prefix[0]}=username]`),selectors.brandname=getValue(`[${prefix[0]}=brandname]`),selectors.email=getValue(`[${prefix[0]}=email]`),selectors.requestorname=getValue(`[${prefix[0]}=name]`);const t=getElement(`[${prefix[0]}=hubspot-brandname]`),r=getElement(`[${prefix[0]}=hubspot-email]`),s=getElement(`[${prefix[0]}=hubspot-username]`),l=getElement(`[${prefix[0]}=hubspot-name]`),n=getElement(`[${prefix[0]}=hidden-form-submit]`);t.value=selectors.brandname,r.value=selectors.email,s.value=selectors.username,l.value=selectors.requestorname,n?.click();const a=await requestForReport();if(selectors.submitBtnLoader.style.display="none",selectors.submitBtn.value="Submit",400===a?.status&&a?.statusText.includes("Invalid buisness email"))selectors.emailErrorLabel.style.display="block";else{if(selectors.popupForm.style.display="none",400===a?.status&&a?.statusText.includes("Max Limit"))return selectors.brandPopupError.style.display="block",void(selectors.brandPopupSuccess.style.display="none");selectors.brandPopupSuccess.style.display="block",selectors.username.value="",selectors.brandname.value="",selectors.email.value=""}},appendInstaUrl=e=>`https://instagram.com/${e}`,requestForReport=async()=>{const e=new URL("https://brand-report-apis.react-webflow-rp.workers.dev/request-report");e.searchParams.append("u",appendInstaUrl(selectors.username)),e.searchParams.append("b",appendInstaUrl(selectors.brandname)),e.searchParams.append("e",selectors.email),e.searchParams.append("n",selectors.requestorname);try{return await(await fetch(e)).json()}catch(e){}},updateUI=e=>{selectors.userName.innerText=e?.userProfileData?.username,selectors.userhandle.innerText=e?.userProfileData?.userhandle,selectors.userFollowersCount.innerText=e?.userProfileData?.followers,selectors.userPicture.src=e?.userProfileData?.profilePicture,setInnerText(selectors.brandName,e?.brandProfileData?.username),setInnerText(selectors.brandhandle,e?.brandProfileData?.userhandle),setInnerText(selectors.brandFollowersCount,e?.brandProfileData?.followers),selectors.brandPicture.src=e?.brandProfileData?.profilePicture};function debounce(e,t=300){let r;return(...s)=>{clearTimeout(r),r=setTimeout((()=>e(...s)),t)}}const Search_URL="https://insightiq-api.nrj.life/search?",fetchAutocompleteResults=debounce((async e=>{const t=new URL(Search_URL);t.searchParams.set("q",e.query),t.searchParams.set("p",e.platform||"it"),t.searchParams.set("sf","ff");try{const r=await(await fetch(t,{method:"GET"})).json();return e.onSuccess(r),r}catch(e){}}),500),handleTextChange=async(e,t,r)=>{t.style.display="block";const s=e.target.value;if(currentHandle=s,!s||!s.length)return t.style.display="none",void(r.innerHTML="");fetchAutocompleteResults({query:s,onSuccess:l=>{t.style.display="none",s.length&&l&&l?.data?.length?(r.innerHTML="",l.data.forEach((t=>{const s=listItem.cloneNode(!0),l=s.querySelector(listItemImgAttr),n=s.querySelector(listItemNameAttr),a=s.querySelector(listItemUsernameAttr),o=s.querySelector(listItemIsVerifiedAttr);l.src=t.picture,l.alt=`${t.fullname}'s image`,n.innerText=t.fullname,a.innerText=`@${t.username}`,t.is_verified||(o.style.display="none"),s.addEventListener("click",(()=>{e.target.value=t.username,currentHandle=t.username,r.style.display="none"})),r.appendChild(s)})),r.style.zIndex=10,r.style.display="flex"):r.innerHTML="<div> No results found </div>"}})},selectors={};let currentHandle=null;const prefix=["form-input","page-item","data","popup-item"],getElement=e=>document.querySelector(e),getValue=e=>getElement(e)?.value,setInnerText=(e,t)=>{e.innerText=t};selectors.brandPopup=getElement(`[${prefix[1]}=brandPopup]`),selectors.brandPopupSuccess=getElement(`[${prefix[1]}=brand-popup-success]`),selectors.brandPopupError=getElement(`[${prefix[1]}=brand-popup-limit]`),selectors.userName=getElement(`[${prefix[1]}=username]`),selectors.brandName=getElement(`[${prefix[1]}=brandname]`),selectors.userhandle=getElement(`[${prefix[1]}=userhandle]`),selectors.brandhandle=getElement(`[${prefix[1]}=brandhandle]`),selectors.userFollowersCount=getElement(`[${prefix[1]}=userFollowersCount]`),selectors.brandFollowersCount=getElement(`[${prefix[1]}=brandFollowersCount]`),selectors.userPicture=getElement(`[${prefix[1]}=userPicture]`),selectors.brandPicture=getElement(`[${prefix[1]}=brandPicture]`),selectors.brandnameErrorLabel=getElement(`[${prefix[1]}=brandname-error-label]`),selectors.usernameErrorLabel=getElement(`[${prefix[1]}=username-error-label]`),selectors.nameErrorLabel=getElement(`[${prefix[1]}=name-error-label]`),selectors.emailErrorLabel=getElement(`[${prefix[1]}=email-error-label]`),selectors.checkAllEmotions=getElement(`[${prefix[1]}=emotions-checkAll]`),selectors.checkAllInterests=getElement(`[${prefix[1]}=interest-checkAll]`),selectors.popupTitleEle=getElement(`[${prefix[3]}="main-title"]`),selectors.popupTileOneEle=getElement(`[${prefix[3]}=title-2]`),selectors.popupTileTwoEle=getElement(`[${prefix[3]}=title-3]`);const resultList=document.querySelector("[data=result-list]"),resultList2=document.querySelector("[data=result-list-1"),listItem=document.querySelector("[data=list-item]"),listItemImgAttr="[data=item-image]",listItemNameAttr="[data=list-item-name]",listItemUsernameAttr="[data=list-item-username]",listItemIsVerifiedAttr="[data=item-is-verified]",mainWrapperEle=getElement(`[${prefix[1]}=main-wrapper]`);selectors.brandnameLoader=getElement(`[${prefix[0]}=loader-dots-brandname]`),selectors.usernameLoader=getElement(`[${prefix[0]}=loader-dots-username]`),selectors.submitBtnLoader=getElement(`[${prefix[0]}=loader-submit]`),selectors.submitBtn=getElement(`[${prefix[0]}=submitBtn]`),selectors.popupForm=getElement(`[${prefix[1]}=second-form]`),selectors.popupOtherSection=getElement(`[${prefix[3]}=other-values]`),selectors.popupItemNormal=getElement(`[${prefix[3]}=other-item]`),selectors.checkAllEmotions.addEventListener("click",(()=>{setInnerText(selectors.popupTitleEle,"All emotions"),setInnerText(selectors.popupTileOneEle,"Shared emotions"),setInnerText(selectors.popupTileTwoEle,"All other emotions"),selectors.popupOtherSection.innerHTML="",allEmotions.slice(1,8).forEach((e=>{const t=selectors.popupItemNormal.cloneNode(!0);setInnerText(t,e),selectors.popupOtherSection.appendChild(t)}))})),selectors.checkAllInterests.addEventListener("click",(()=>{setInnerText(selectors.popupTitleEle,"All interests"),setInnerText(selectors.popupTileOneEle,"Shared interests"),setInnerText(selectors.popupTileTwoEle,"All other interests"),selectors.popupOtherSection.innerHTML="",allInterests.slice(6,12).map((e=>e.name)).forEach((e=>{const t=selectors.popupItemNormal.cloneNode(!0);setInnerText(t,e),selectors.popupOtherSection.appendChild(t)}))})),mainWrapperEle.addEventListener("click",(()=>{resultList.innerHTML="",resultList2.innerHTML=""})),selectors.userNameInput=getElement(`[${prefix[0]}=username]`).addEventListener("input",(e=>handleTextChange(e,selectors.usernameLoader,resultList2))),selectors.brandNameInput=getElement(`[${prefix[0]}=brandname]`).addEventListener("input",(e=>handleTextChange(e,selectors.brandnameLoader,resultList))),selectors.analyzeBtnClick=getElement(`[${prefix[0]}=analyzeBtn]`)?.addEventListener("click",analyze),selectors.submitBtnClick=getElement(`[${prefix[0]}=submitBtn]`)?.addEventListener("click",formSubmit);const allEmotions=["Admiration","Excitement","Disapproval","Caring","Confusion","Optimism","Disappointment","Fear","Surprise","Neutral"],allInterests=[{name:"Television & Film"},{name:"Music"},{name:"Shopping & Retail"},{name:"Coffee, Tea & Beverages"},{name:"Camera & Photography"},{name:"Clothes, Shoes, Handbags & Accessories"},{name:"Beer, Wine & Spirits"},{name:"Sports"},{name:"Electronics & Computers"},{name:"Gaming"},{name:"Activewear"},{name:"Art & Design"},{name:"Travel, Tourism & Aviation"},{name:"Business & Careers"},{name:"Beauty & Cosmetics"},{name:"Healthcare & Medicine"},{name:"Jewellery & Watches"},{name:"Restaurants, Food & Grocery"},{name:"Toys, Children & Baby"},{name:"Fitness & Yoga"},{name:"Wedding"},{name:"Tobacco & Smoking"},{name:"Pets"},{name:"Healthy Lifestyle"},{name:"Luxury Goods"},{name:"Home Decor, Furniture & Garden"},{name:"Friends, Family & Relationships"},{name:"Cars & Motorbikes"}];