const urlParams=new URLSearchParams(window.location.search),reqId=urlParams.get("uuid"),fetchReportDetails=async e=>{const t=new URL("https://brand-report-apis.react-webflow-rp.workers.dev/get-report");t.searchParams.append("reqId",e);try{return await(await fetch(t)).json()}catch(e){}},selectors={},prefix=["form-input","page-item","data"],getElement=e=>document.querySelector(e),getValue=e=>getElement(e)?.value,setInnerText=(e,t)=>{e.innerText=t};function calculateRotation(e){return e=Math.max(0,Math.min(100,e)),Math.round(e/100*180)}selectors.brandPopup=getElement(`[${prefix[1]}=brandPopup]`),selectors.userName=getElement(`[${prefix[1]}=username]`),selector.mUsername=getElement(`[${prefix[1]}=m-username]`),selectors.mUserhandle=getElement(`[${prefix[1]}=m-userhandle]`),selectors.brandName=getElement(`[${prefix[1]}=brandname]`),selectors.mBrandname=getElement(`[${prefix[1]}=m-brandname]`),selectors.mBrandhandle=getElement(`[${prefix[1]}=m-brandhandle]`),selectors.userhandle=getElement(`[${prefix[1]}=userhandle]`),selectors.brandhandle=getElement(`[${prefix[1]}=brandhandle]`),selectors.userFollowersCount=getElement(`[${prefix[1]}=userFollowersCount]`),selectors.brandFollowersCount=getElement(`[${prefix[1]}=brandFollowersCount]`),selectors.userPicture=getElement(`[${prefix[1]}=userPicture]`),selectors.brandPicture=getElement(`[${prefix[1]}=brandPicture]`),selectors.matchScore=getElement(`[${prefix[1]}=matchScore]`),selectors.matchScoreComment=getElement(`[${prefix[1]}=match-comment]`),selectors.userCPQ=getElement(`[${prefix[1]}=userCPQ]`),selectors.brandCPQ=getElement(`[${prefix[1]}=brandCPQ]`),selectors.CPQ=getElement(`[${prefix[1]}=CPQ]`),selectors.CPQWidth=getElement(`[${prefix[1]}=CPQ-width]`),selectors.toneMatch=getElement(`[${prefix[1]}=toneMatch]`),selectors.toneMatchWidth=getElement(`[${prefix[1]}=toneMatchWidth]`),selectors.interestMatch=getElement(`[${prefix[1]}=interestMatch]`),selectors.interestMatchWidth=getElement(`[${prefix[1]}=interestMatchWidth]`),selectors.fullReportPage=getElement(`[${prefix[1]}=full-report]`),selectors.mainLoaderEle=getElement(`[${prefix[1]}=main-loader]`),selectors.drivingCircleEle=getElement(`[${prefix[1]}=driving-circle]`),selectors.commonEmotionsEle=getElement(`[${prefix[1]}=emotions-row]`),selectors.emotionChipEle=getElement(`[${prefix[1]}=emotion-chip]`),selectors.emotionsCheckAllEle=getElement(`[${prefix[1]}=emotions-checkAll]`),selectors.commonInterestsEle=getElement(`[${prefix[1]}=interests-row]`),selectors.interestsCheckAllEle=getElement(`[${prefix[1]}=interests-checkAll]`),selectors.sharedPopupEle=getElement(`[${prefix[1]}=shared-popup]`),selectors.sharedPopEleTitle=getElement(`[${prefix[1]}=sharedPopup-title]`),selectors.sharedPopupEleCreatorImage=getElement(`[${prefix[1]}=sharedPopup-userimage]`),selectors.sharedPopupEleCreatorname=getElement(`[${prefix[1]}=sharedPopup-username]`),selectors.sharedPopupEleCreatorhandle=getElement(`[${prefix[1]}=sharedPopup-userhandle]`),selectors.sharedPopupEleBrandImage=getElement(`[${prefix[1]}=sharedPopup-brandimage]`),selectors.sharedPopupEleBrandname=getElement(`[${prefix[1]}=sharedPopup-brandname]`),selectors.sharedPopupEleBrandhandle=getElement(`[${prefix[1]}=sharedPopup-brandhandle]`),selectors.graphPoint=getElement(`[${prefix[1]}=graph-pointer]`),selectors.popupSubtitle=getElement(`[${prefix[1]}=popup-subtitle]`),selectors.sharedItems=getElement(`[${prefix[1]}=popup-shareditems]`),rotateItem=(e,t)=>{const r=-90+t;e.style.transform="rotate("+r+"deg)",e.style.webkitTransform="rotate("+r+"deg)",e.style.mozTransform="rotate("+r+"deg)",updateDotBorderColorNText(r)};const updateDotBorderColorNText=e=>{let t="",r="";e>-91&&e<-27&&(t="#f70c10",r="Not a fit"),e>-27&&e<20&&(t="#e4be13",r="Could be a match"),e>20&&e<51&&(t="#3ff70c",r="Great Fit"),e>51&&e<91&&(t="#065e09",r="Couldnâ€™t get better"),selectors.graphPoint.style.borderColor=t,setInnerText(selectors.matchScoreComment,r)},updateReportPage=e=>{e&&(setInnerText(selectors.userName,e?.userProfileData?.username),setInnerText(selectors.mUsername,e?.userProfileData?.username),setInnerText(selectors.mUserhandle,e?.userhandle),setInnerText(selectors.userhandle,e?.userProfileData?.userhandle),setInnerText(selectors.userFollowersCount,e?.userProfileData?.followers),selectors.userPicture.src=e?.userProfileData?.profilePicture,setInnerText(selectors.brandName,e?.brandProfileData?.username),setInnerText(selectors.brandhandle,e?.brandProfileData?.userhandle),setInnerText(selectors.mBrandname,e?.brandProfileData?.username),setInnerText(selectors.mBrandhandle,brandProfileData?.userhandle),setInnerText(selectors.brandFollowersCount,e?.brandProfileData?.followers),selectors.brandPicture.src=e?.brandProfileData?.profilePicture,rotateItem(selectors.drivingCircleEle,calculateRotation(e?.matchScore)),setInnerText(selectors.matchScore,e?.matchScore),setInnerText(selectors.userCPQ,e?.userCPQ),setInnerText(selectors.brandCPQ,e?.brandCPQ),setInnerText(selectors.CPQ,e?.CPQ),selectors.CPQWidth.style.width=e?.CPQWidth,setInnerText(selectors.toneMatch,e?.toneMatch),selectors.toneMatchWidth.style.width=e?.toneMatchWidth,setInnerText(selectors.interestMatch,e?.interestMatch),selectors.interestMatchWidth.style.width=e?.interestMatchWidth,setInnerText(selectors.sharedPopupEleBrandname,e?.brandProfileData?.username),setInnerText(selectors.sharedPopupEleBrandhandle,e?.brandProfileData?.userhandle),selectors.sharedPopupEleBrandImage.src=e?.brandProfileData?.profilePicture,setInnerText(selectors.sharedPopupEleCreatorname,e?.userProfileData?.username),setInnerText(selectors.sharedPopupEleCreatorhandle,e?.userProfileData?.userhandle),selectors.sharedPopupEleCreatorImage.src=e?.userProfileData?.profilePicture,e?.sharedEmotions?.length>4&&(selectors.emotionsCheckAllEle.style.display="block",selectors.emotionsCheckAllEle.addEventListener("click",(()=>{selectors.sharedPopupEle.style.display="block"})),setInnerText(selectors.sharedPopEleTitle,"Shared Tones"),selectors.sharedItems.innerHTML="",e?.sharedEmotions?.forEach((e=>{const t=selectors.emotionChipEle?.cloneNode(!0);setInnerText(t,e),selectors.sharedItems.appendChild(t)}))),selectors.commonEmotionsEle.innerHTML="",e?.sharedEmotions?.slice(0,4)?.forEach((e=>{const t=selectors.emotionChipEle?.cloneNode(!0);setInnerText(t,e),selectors.commonEmotionsEle.appendChild(t)})),e?.sharedInterests?.length>4&&(selectors.interestsCheckAllEle.style.display="block",selectors.interestsCheckAllEle.addEventListener("click",(()=>{selectors.sharedPopupEle.style.display="block"})),setInnerText(selectors.sharedPopEleTitle,"Shared Interests"),setInnerText(selectors.popupSubtitle,"Shared Interests"),selectors.sharedItems.innerHTML="",e?.sharedInterests?.forEach((e=>{const t=selectors.emotionChipEle?.cloneNode(!0);setInnerText(t,e),selectors.sharedItems.appendChild(t)}))),selectors.commonInterestsEle.innerHTML="",e?.sharedInterests?.slice(0,4)?.forEach((e=>{const t=selectors.emotionChipEle?.cloneNode(!0);setInnerText(t,e),selectors.commonInterestsEle.appendChild(t)})))},init=async()=>{reqId&&""!==reqId||(alert("Report Url is invalid. Please request a new report"),window.location.href="https://phyllo.webflow.io/brand-fit"),selectors.fullReportPage.style.display="none",selectors.mainLoaderEle.style.display="block";const e=await fetchReportDetails(reqId);e.status,updateReportPage(e),selectors.mainLoaderEle.style.display="none",selectors.fullReportPage.style.display="block"};window.addEventListener("load",init);